#make the conda
conda config --add channels defaults
conda config --add channels bioconda
conda config --add channels conda-forge
conda config --set channel_priority strict
conda create --name hybpiper -c chrisjackson-pellicle hybpiper
conda activate hybpiper #verion 2.3.1

#move to the folder with all of the allopolyploid samples + the subgenome references
cd /data/labs/Fant/Quigg/hybpiper/01.trimmed/tetraploids3

#generate the assembly script
for i in *R1_paired.fastq.gz
do f2=${i//_R1_/_R2_}
f3=${i//_R1_paired.fastq.gz/}
echo hybpiper assemble -t_dna /data/labs/Fant/Quigg/hybpiper/target_file3.fasta -r $i $f2 --prefix $f3 --bwa >> assemble.sh
done

#change permissions
chmod +x assemble.sh

#run it
screen -L ./assemble.sh

#run the stats once it's finshed
hybpiper stats -t_dna /data/labs/Fant/Quigg/hybpiper/target_file3.fasta gene namefile.txt

#generate a heatmap
hybpiper recovery_heatmap seq_lengths.tsv

#I moved all of the folders into a new directory
